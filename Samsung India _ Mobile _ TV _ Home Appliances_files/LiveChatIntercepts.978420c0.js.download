((self||this)["webpackJsonp@sprinklr/chat-web-client"]=(self||this)["webpackJsonp@sprinklr/chat-web-client"]||[]).push([[38],{1870:function(e,t,a){"use strict";a.r(t);var r=a(384),n=a.n(r),i=a(122),c=a.n(i),s=a(459),d=a.n(s),I=a(196),o=a.n(I),E=a(723),p=a(563);const l="CLOSED",u="TRIGGERED";var v=a(15),C=a(121),O=a(547);const T=e=>{switch(e){case O.a.CLOSE:case O.a.URL:return e;default:return"NEW_CONVERSATION"}},b=e=>{const{interceptId:t,creative:a,targets:n,onClose:i,settings:s,creativeId:I}=e,O=Object(v.b)(),b=(e=>{let{interceptId:t,targets:a,creativeId:n}=e;const i=Object(E.a)({targets:a,interceptId:t,creativeId:n});return Object(r.useCallback)((e=>e.type===l?i({type:p.a.CLOSE}):e.type===u?i({type:p.a.TRIGGERED}):i({type:p.a.ENGAGE,buttonId:o()(e,"button.id")})),[i])})({interceptId:t,targets:n,creativeId:I}),{createCase:R,disableManualResponse:y=!1}=Object(r.useMemo)((()=>d()(s)?{createCase:o()(a,"additional.createCase"),disableManualResponse:o()(a,"disableManualResponse")}:{createCase:o()(s,"liveChatCreateCase"),disableManualResponse:o()(s,"liveChatDisableManualResponse")}),[a,s]);return Object(r.useEffect)((()=>{const e=e=>{e.id===t&&b(e).catch((e=>{Object(C.b)(e)})).finally((()=>{e.type!==u&&i(t)}))};return O.sprChat("onPromptAction",e),()=>{O.sprChat("offPromptAction",e)}}),[]),Object(r.useEffect)((()=>(O.sprChat("openNewPrompt",{id:t,messages:[{text:a.text,disableManualResponse:y}],buttons:c()(a.buttons,(e=>({id:e.id,label:e.title,type:T(o()(n,[`${e.id}`,"type"])),value:o()(n,[`${e.id}`,"value"])}))),additional:{...o()(a,"additional"),createCase:R,interceptId:t,creativeId:I}}),()=>{O.sprChat("clearPrompt",{id:t})})),[t,a,n]),null};var R=n.a.memo(b),y=a(491),G=a(385);const N=e=>{let{intercepts:t,onClose:a}=e;return Object(G.jsx)(n.a.Fragment,null,c()(t,(e=>{const t=y.a.getId(e);return Object(G.jsx)(R,{key:t,interceptId:t,creativeId:y.a.getCreativeId(e),creative:y.a.getCreative(e),targets:y.a.getTargets(e),onClose:a,settings:y.a.getSettings(e)})})))};t.default=n.a.memo(N)},612:function(e,t,a){"use strict";var r=a(384),n=a(641),i=a(524);t.a=()=>{const{refetch:e}=Object(n.a)({skipQueryOnMount:!0});return Object(r.useCallback)((t=>{const{type:a,payload:r}=t;switch(a){case i.a.INTERCEPT_TRIGGERED:return e({eventType:i.a.INTERCEPT_TRIGGERED,eventId:r.interceptId,details:{creativeId:r.creativeId}});case i.a.INTERCEPT_SNOOZE_TRIGGERED:return e({eventType:i.a.INTERCEPT_SNOOZE_TRIGGERED,eventId:r.interceptId,details:{creativeId:r.creativeId}});case i.a.INTERCEPT_ENGAGED:return e({eventType:i.a.INTERCEPT_ENGAGED,eventId:r.interceptId,details:{targetId:r.targetId,creativeId:r.creativeId}});case i.a.SNOOZE:return e({eventType:i.a.SNOOZE,eventId:r.interceptId,details:{targetId:r.targetId,creativeId:r.creativeId}});default:return e({eventType:i.a.INTERCEPT_CLOSED,eventId:r.interceptId,details:{creativeId:r.creativeId}})}}),[])}},723:function(e,t,a){"use strict";var r=a(384),n=a(598),i=a(612),c=a(642);var s=a(524),d=a(563),I=a(547);t.a=function(e){let{targets:t,interceptId:a,creativeId:o}=e;const E=Object(i.a)(),p=Object(r.useContext)(n.a);return Object(r.useCallback)((e=>{const r=()=>{E({type:s.a.INTERCEPT_CLOSED,payload:{interceptId:a,creativeId:o}}),p.setAction(a,d.a.CLOSE)};return new Promise(((n,i)=>{const{type:l,buttonId:u}=e;if(l===d.a.CLOSE)return r(),void n();if(l===d.a.TRIGGERED)return E({type:s.a.INTERCEPT_TRIGGERED,payload:{interceptId:a,creativeId:o}}),void n();if(l===d.a.SNOOZE)return(e=>{E({type:s.a.SNOOZE,payload:{targetId:e,interceptId:a,creativeId:o}})})(),void n();if(l===d.a.ENGAGE){if(u){const e=((e,t)=>t&&e?t[e]:void 0)(u,t),a=e&&c.a.getType(e);if(!a)return void n();if(a===I.a.CLOSE)return r(),void n()}return(e=>{E({type:s.a.INTERCEPT_ENGAGED,payload:{targetId:e,interceptId:a,creativeId:o}}),p.setAction(a,d.a.ENGAGE)})(u),void n()}n()}))}),[E,t,a])}}}]);